{% extends 'dashboard_base.html' %}

{% block dashboardstyles %}
<style>
  .form-container {
    background-color: #f2f2f2;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    color: #777;
  }

  .form-container h1 {
    font-size: 28px;
    font-weight: bold;
    margin-bottom: 20px;
  }

  .form-container .form-group {
    margin-bottom: 20px;
  }

  .form-container label {
    font-weight: bold;
  }

  .form-container input[type="text"],
  .form-container input[type="email"],
  .form-container input[type="password"],
  .form-container input[type="file"],
  .form-container input[type="date"] {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
  }

  .form-container .filename {
    display: block;
    margin-top: 5px;
    font-style: italic;
  }

  .form-container button[type="submit"] {
    background-color: #321772;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
  }

  .form-container button[type="submit"]:hover {
    background-color: #200e49;
  }
  .add-btn {
    background-color: #ffffff;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 15px;
    transition: background-color 0.3s ease;
  }
  .add-btn:hover,
  .add-btn:focus {
    background-color: #321772;
    border: #321772 1px solid;
    color: white;
  }
  .remove-field {
    background-color: #ffffff;
    padding: 5px;
    border: 1px solid #ccc;
    border-radius: 15px;
    transition: background-color 0.3s ease;
    margin: 5px;
  }
  .remove-field:hover,
  .remove-field:focus {
    background-color: #321772;
    border: #321772 1px solid;
    color: white;
  }
</style>
{% endblock dashboardstyles %}

{% block dashboardbody %}
<h1>Update User Profile</h1>
<div class="form-container">
  <form method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="form-group">
      <label for="id_username">Username:</label>
      <input
        type="text"
        id="id_username"
        name="username"
        value="{{ form.username.value }}"
        class="form-control"
      />
    </div>
    <div class="form-group">
      <label for="id_first_name">First Name:</label>
      <input
        type="text"
        id="id_first_name"
        name="first_name"
        value="{{ form.first_name.value }}"
        class="form-control"
      />
    </div>
    <div class="form-group">
      <label for="id_last_name">Last Name:</label>
      <input
        type="text"
        id="id_last_name"
        name="last_name"
        value="{{ form.last_name.value }}"
        class="form-control"
      />
    </div>
    <div class="form-group">
      <label for="id_email">Email:</label>
      <input
        type="email"
        id="id_email"
        name="email"
        value="{{ form.email.value }}"
        class="form-control"
      />
    </div>
    <div class="form-group">
      <label for="id_dob">Date of Birth:</label>
      <input
        type="date"
        id="id_dob"
        name="dob"
        value="{% if form.instance.userprofile.dob %}{{ form.instance.userprofile.dob|date:'Y-m-d' }}{% endif %}"
        class="form-control"
      />
    </div>
    <div class="form-group">
      <label for="id_phone_number">Phone Number:</label>
      <input
        type="text"
        id="id_phone_number"
        name="phone_number"
        value="{{ form.instance.userprofile.phone_number }}"
        class="form-control"
      />
    </div>
    <div class="form-group">
      <label for="id_address">Address:</label>
      <input
        type="text"
        id="id_address"
        name="address"
        value="{{ form.instance.userprofile.address }}"
        class="form-control"
      />
    </div>
    <div class="form-group">
      <label for="id_linkedin_profile">LinkedIn Profile:</label>
      <input
        type="text"
        id="id_linkedin_profile"
        name="linkedin_profile"
        value="{{ form.instance.userprofile.linkedin_profile }}"
        class="form-control"
      />
    </div>
    <div class="form-group">
      <label for="id_facebook_profile">Facebook Profile:</label>
      <input
        type="text"
        id="id_facebook_profile"
        name="facebook_profile"
        value="{{ form.instance.userprofile.facebook_profile }}"
        class="form-control"
      />
    </div>
    <div class="form-group">
      <label for="id_instagram_profile">Instagram Profile:</label>
      <input
        type="text"
        id="id_instagram_profile"
        name="instagram_profile"
        value="{{ form.instance.userprofile.instagram_profile }}"
        class="form-control"
      />
    </div>
    <div class="form-group">
      <label for="id_profile_picture">Profile Picture:</label>
      <input
        type="file"
        id="id_profile_picture"
        name="profile_picture"
        class="form-control-file form-control"
      />
      <span class="filename"></span>
    </div>
    <div class="form-group">
      <label for="id_education">Education:</label>
      <div id="education-fields">
        {% for education in existing_education %}
        <div class="education-field">
          {{ education.institution }}
          <input
            type="text"
            name="education-{{ forloop.counter0 }}-degree"
            value="{{ education.degree }}"
            class="form-control"
            placeholder="Degree"
          />
          <input
            type="text"
            name="education-{{ forloop.counter0 }}-year"
            value="{{ education.year }}"
            class="form-control"
            placeholder="Year"
          />
          <button type="button" class="remove-field">Remove</button>
        </div>
        {% endfor %}
      </div>
      <button type="button" class="add-btn" id="add-education-btn">
        Add Education
      </button>
    </div>
    
    <div class="form-group">
      <label for="id_skill">Skills:</label>
      <div id="skill-fields">
        {% for skill in existing_skills %}
        <div class="skill-field">
          <input
            type="text"
            name="skill-{{ forloop.counter0 }}"
            value="{{ skill.skill }}"
            class="form-control"
            placeholder="Skill"
          />
          <button type="button" class="remove-field">Remove</button>
        </div>
        {% endfor %}
      </div>
      <button type="button" class="add-btn" id="add-skill-btn">
        Add Skill
      </button>
    </div>
    
    <br />
    <button type="submit">Update</button>
    </form>
    </div>
    {% endblock dashboardbody %} 
    
    {% block dashjs %}
    <script>
      // Add Education
      var educationFieldsContainer = document.getElementById('education-fields');
      var addEducationBtn = document.getElementById('add-education-btn');
      var educationFieldIndex = {{ existing_education|length }};
    
      addEducationBtn.addEventListener('click', function() {
        var educationField = document.createElement('div');
        educationField.className = 'education-field';
        educationField.innerHTML = `
          <input type="text" name="education-${educationFieldIndex}-institution" class="form-control" placeholder="Institution">
          <input type="text" name="education-${educationFieldIndex}-degree" class="form-control" placeholder="Degree">
          <input type="text" name="education-${educationFieldIndex}-year" class="form-control" placeholder="Year">
          <button type="button" class="remove-field">Remove</button>
        `;
        educationFieldsContainer.appendChild(educationField);
        educationFieldIndex++;
      });
    
      // Remove Education
      educationFieldsContainer.addEventListener('click', function(e) {
        if (e.target.classList.contains('remove-field')) {
          e.target.parentElement.remove();
        }
      });
    
      // Add Skill
      var skillFieldsContainer = document.getElementById('skill-fields');
      var addSkillBtn = document.getElementById('add-skill-btn');
      var skillFieldIndex = {{ existing_skills|length }};
    
      addSkillBtn.addEventListener('click', function() {
        var skillField = document.createElement('div');
        skillField.className = 'skill-field';
        skillField.innerHTML = `
          <input type="text" name="skill-${skillFieldIndex}" class="form-control" placeholder="Skill">
          <button type="button" class="remove-field">Remove</button>
        `;
        skillFieldsContainer.appendChild(skillField);
        skillFieldIndex++;
      });
    
      // Remove Skill
      skillFieldsContainer.addEventListener('click', function(e) {
        if (e.target.classList.contains('remove-field')) {
          e.target.parentElement.remove();
        }
      });
    </script>
    {% endblock dashjs %}
    